<!--
  ~ Date:2022/1/10 18:55 25
  ~ Name:懒加载.html
  ~ Path:Web代码/src/com/charlatan/homework/1月/10号【周一】
  ~ ProjectName:WWW
  ~ Author:charlatan
  ~
  ~  Il n'ya qu'un héroïsme au monde : c'est de voir le monde tel qu'il est et de l'aimer.
  -->
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>懒加载</title>
	<style>
		* {
			margin: 0;
			padding: 0;
			list-style: none;
			font-size: 15px;
			text-decoration: none;
		}
		
		li {
			cursor: pointer;
			position: relative;
		}
		
		/*-------以上为默认设置（The above is the default setting）--------*/
		
		#ul {
			width: 1400px;
			position: absolute;
			left: 0;
			right: 0;
			margin: auto;
			background-color: #d5fdaa;
		}
		
		#ul:after {
			display: block;
			content: '';
			clear: both;
			
		}
		
		#ul > li {
			width: 200px;
			float: left;
			margin: 20px 15px;
		}
		
		.img {
			height: 470px;
			width: 210px;
		}

		.i {
			width: 210px;
			height: 270px;
		}

		.li {
			height: 470px;
			width: 210px;
		}
	</style>
</head>
<body>
<ul id="ul">

	<li>
		<img alt="" class="img" src="file/img-1.jpg">
	</li>
	<li>
		<img alt="" class="img" src="file/img-2.jpg">
	</li>
	<li>
		<img alt="" class="img" src="file/img-3.jpg">
	</li>
	<li>
		<img alt="" class="img" src="file/img-4.jpg">
	</li>
	<li>
		<img alt="" class="img" src="file/img-4.jpg">
	</li>
	<li>
		<img alt="" class="img" src="file/img-1.jpg">
	</li>
	<li>
		<img alt="" class="img" src="file/img-2.jpg">
	</li>
	<li>
		<img alt="" class="img" src="file/img-3.jpg">
	</li>
	<li>
		<img alt="" class="img" src="file/img-4.jpg">
	</li>
	<li>
		<img alt="" class="img" src="file/img-4.jpg">
	</li>
	<li>
		<img alt="" class="img" src="file/img-1.jpg">
	</li>
	<li>
		<img alt="" class="img" src="file/img-2.jpg">
	</li>
	<li>
		<img alt="" class="img" src="file/img-3.jpg">
	</li>
	<li>
		<img alt="" class="img" src="file/img-4.jpg">
	</li>
	<li>
		<img alt="" class="img" src="file/img-4.jpg">
	</li>
	<li>
		<img alt="" class="img" src="file/img-1.jpg">
	</li>
	<li>
		<img alt="" class="img" src="file/img-2.jpg">
	</li>
	<li>
		<img alt="" class="img" src="file/img-3.jpg">
	</li>

</ul>
</body>
<script>
	let ul = document.getElementById('ul')
	let li = `
		<li class="li">
			<img alt="" class="img i" src="file/load.gif">
		</li>
		<li class="li">
			<img alt="" class="img i" src="file/load.gif">
		</li>
		<li class="li">
			<img alt="" class="img i" src="file/load.gif">
		</li>
		<li class="li">
			<img alt="" class="img i" src="file/load.gif">
		</li>
		<li class="li">
			<img alt="" class="img i" src="file/load.gif">
		</li>
		<li class="li">
			<img alt="" class="img i" src="file/load.gif">
		</li>
`
	document.onscroll = fd(onscroll, 1000)

	// document.onscroll = onscroll

	function onscroll(event) {
		let sh = document.documentElement.scrollHeight - document.documentElement.scrollTop
		let ch = document.documentElement.clientHeight

		if (sh - ch <= 300) {
			ul.innerHTML += li
			setTimeout(change, 1000)
		}
		setTimeout(change, 10000)

		function change() {
			let i = document.getElementsByClassName('i')
			for (let j = 0; j < i.length; j++) {
				let num = Math.floor(Math.random() * 14) + 1
				i[j].src = "file/img-" + num + ".jpg"
				i[j].classList.remove('i')
			}
		}

		console.log("123");
	}

	function fd(callback, time) {
		let timer
		let flag = true
		return function () {
			if (flag) {
				callback()
				flag = false
			} else {
				timer = setTimeout(function () {
					flag = true
					clearTimeout(timer)
				}, time)
			}
		}
	}
</script>
</html>