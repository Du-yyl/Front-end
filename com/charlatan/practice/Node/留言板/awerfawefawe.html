<!--
  ~ Time:2022/2/14 22:35 09
  ~ Name:awerfawefawe.html
  ~ Path:Web代码/src/com/charlatan/practice/Node/留言板
  ~ ProjectName:WWW
  ~ Author:charlatan
  ~
  ~  Il n'ya qu'un héroïsme au monde : c'est de voir le monde tel qu'il est et de l'aimer.
  -->
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta content="IE=edge" http-equiv="X-UA-Compatible">
	<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
	<title>Title</title>
	<style>
		* {
			margin: 0;
			padding: 0;
			list-style: none;
			font: 500 15px YouYuan;
			text-decoration: none;
		}

		li {
			cursor: pointer;
			position: relative;
		}

		/*-------以上为默认设置（The above is the default setting）--------*/

		.img {
			width: 20px;
			height: 20px;
			display: inline
		}

		#div {
			width: 800px;
			height: 100px;
			border: 1px solid red;
			border-radius: 5px;
		}

		.div[contenteditable]:empty:before {
			content: attr(placeholder);
			color: #777575;
		}

		.div[contenteditable]:focus {
			content: none;
		}

	</style>
</head>
<body>
<div id="div" class="div" placeholder="请在这输入内容" contenteditable="true">我是测试使用的文本<img src="file/music-bg.jpg" alt="1"
                                                                                     name="2" class="img"><img
		src="file/music-bg.jpg" alt="1" name="2" class="img"><img src="file/music-bg.jpg" alt="1" name="2" class="img">我是测试文本
</div>
<button type="button" id="btn">按钮</button>
</body>
<script>
	let div = document.getElementById('div')
	let btn = document.getElementById('btn')

	let str = '~~~'
	let selection = document.getSelection()

	btn.onclick = function () {
		// for (let selectionKey in selection) {
		// 	console.log(selectionKey, ' +-+-> ', selection[selectionKey])
		// }

		// console.log(selection.anchorNode)
		// console.log(selection.focusNode)
		// console.log(selection.anchorOffset)
		insertStart(div, selection.anchorOffset, str)
	}

	/**
	 *
	 * @param element 谁
	 * @param index 什么位置
	 * @param text 什么内容
	 */
	function insertStart (element, index, text) {

		element.innerHTML = element.innerHTML.slice(0, index) + text + element.innerHTML.slice(index)
	}

	// let div_text = div.innerText
	//
	// let range = document.createRange()
	//
	// // let text = "我是添加的文本"
	// let text = document.createElement('SPAN')
	//
	// range.setStart(div_text,2)
	// range.insertNode(text)

	// var oP1 = document.getElementById("p1");
	// var oHello = oP1.firstChild.firstChild;
	// var oWorld = oP1.lastChild;
	// var oRange = document.createRange();
	// var oSpan = document.createElement("span");
	// oSpan.style.color = "red";
	// oSpan.appendChild(document.createTextNode("Inserted text"));
	//
	// oRange.setStart(oHello, 2);
	// oRange.setEnd(oWorld, 3);
	// oRange.insertNode(oSpan);
</script>

</html>
